#version 430

layout (local_size_x = 1, local_size_y = 1, local_size_z = 1) in;

uniform samplerBuffer commandBuf;
writeonly uniform uimageBuffer valuesBuf;

uniform ivec4 dimens; // ivec4(width, height, 0, 0)

void main() {
  ivec3 pos = ivec3(gl_GlobalInvocationID);

  uvec4 color = uvec4(
    0, uint(texelFetch(commandBuf, pos.x).x), 0, 255
  );

  imageStore(valuesBuf, pos.y * dimens.x + pos.x, color);
}
